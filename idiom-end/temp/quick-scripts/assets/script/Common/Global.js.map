{"version":3,"sources":["Global.js"],"names":["querystring","require","Global","globalSocket","hallSocket","queueSocket","roomSocket","gameManager","stand","prename","time","win","nickName","avatar","name","JSONData","Duan_JSONData","checkpoint","times","openid","server_id","UserInfo","sendHttpPost","callback","self","request","cc","loader","getXMLHttpRequest","url","open","setRequestHeader","onreadystatechange","readyState","status","response","responseText","JSON","parse","row","direction","split","idiom","hideword","index","pingyin","explain","chuchu","i","length","obj","id","parseInt","push","send","sendHttpPost_duan","console","log","rows","words","answer","rightIndex","right_index","RightIndex","sendHttpPost_times","sendHttpPost_save_times","sendCodePost","code","sendUserInfo","userData","userInfo","avatarUrl","getData","stringify","open_id","nick_name","avatar_url","gender","country","province","city","module","exports"],"mappings":"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","file":"Global.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\Common","sourcesContent":["//用来存储从服务器拿来的数据\r\nlet querystring = require('querystring');\r\nconst Global = {\r\n    globalSocket:null,\r\n    hallSocket:null,\r\n    queueSocket:null,\r\n    roomSocket:null,\r\n    gameManager:null,\r\n    stand:'',\r\n    prename:'',\r\n    time:'',\r\n    win:'你赢了',//赢家\r\n\r\n    nickName:'',//用户昵称\r\n    avatar:'',//用户头像\r\n    name:'',\r\n\r\n    JSONData: [],\r\n    Duan_JSONData: [],\r\n    checkpoint: 1,\r\n    times: 3,\r\n    openid:'',\r\n    server_id:'',\r\n    UserInfo: {},\r\n    sendHttpPost(callback) {\r\n        let self = this;\r\n        let request = cc.loader.getXMLHttpRequest();\r\n        let url = 'https://game.i--j.com/user/game';\r\n        request.open('POST', url, true);\r\n        request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        request.onreadystatechange = function () {\r\n            if (request.readyState === 4 && (request.status >= 200 && request.status < 300)) {\r\n                let response = request.responseText;\r\n                response = JSON.parse(response);\r\n                //console.log(response);\r\n                let row = response.row;\r\n                let direction = row.direction.split(/,/);\r\n                let idiom = row.idiom.split(/,/);\r\n                let hideword = row.hideword.split(/,/);\r\n                let index = row.index.split(/,/);\r\n                let pingyin = row.pingyin.split(/,/);\r\n                let explain = row.explain.split(/,/);\r\n                let chuchu = row.chuchu.split(/,/);\r\n                for (let i = 0; i < direction.length; i++) {\r\n                    let obj = {\r\n                        id: i,\r\n                        direction: parseInt(direction[i]),\r\n                        idiom: idiom[i],\r\n                        hideword: hideword[i],\r\n                        index: parseInt(index[i]),\r\n                        pingyin: pingyin[i],\r\n                        chuchu: chuchu[i],\r\n                        explain: explain[i]\r\n                    };\r\n                    self.JSONData.push(obj);\r\n                }\r\n                if (callback){\r\n                    callback();\r\n                }\r\n            }\r\n        };\r\n        request.send('checkpoint=' + self.checkpoint);\r\n    },\r\n\r\n    sendHttpPost_duan(callback) {\r\n        let self = this;\r\n        let request = cc.loader.getXMLHttpRequest();\r\n        let url = 'https://game.i--j.com/user/duan';\r\n        request.open('POST', url, true);\r\n        request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        request.onreadystatechange = function () {\r\n            if (request.readyState === 4 && (request.status >= 200 && request.status < 300)) {\r\n                let response = request.responseText;\r\n                response = JSON.parse(response);\r\n                console.log(response);\r\n                let row = response.rows;\r\n                for (let i = 0; i < row.length; i++) {\r\n                    let words = row[i].words;\r\n                    let index = row[i].index;\r\n                    let answer = row[i].answer.split('|');\r\n                    let rightIndex = row[i].right_index;\r\n                    let explain = row[i].explain;\r\n                    let obj = {\r\n                        id: i,\r\n                        words: words,\r\n                        index: parseInt(index),\r\n                        answer: answer,\r\n                        RightIndex: parseInt(rightIndex),\r\n                        explain: explain\r\n                    };\r\n                    self.Duan_JSONData.push(obj);\r\n                }\r\n                console.log(self.Duan_JSONData);\r\n                if (callback){\r\n                    callback();\r\n                }\r\n            }\r\n        };\r\n        request.send();\r\n    },\r\n    sendHttpPost_times(openid) {\r\n        let self = this;\r\n        let request = cc.loader.getXMLHttpRequest();\r\n        let url = 'https://game.i--j.com/user/info';\r\n        request.open('POST', url, true);\r\n        request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        request.onreadystatechange = function () {\r\n            if (request.readyState === 4 && (request.status >= 200 && request.status < 300)) {\r\n                let response = request.responseText;\r\n                response = JSON.parse(response);\r\n                console.log(\"response  ::\"+response);\r\n                self.times = response.row.times;\r\n                console.log('tttttttttt'+self.times);\r\n            }\r\n        };\r\n        request.send('open_id='+openid);\r\n    },\r\n    sendHttpPost_save_times(openid,times) {\r\n        let self = this;\r\n        let request = cc.loader.getXMLHttpRequest();\r\n        let url = 'https://game.i--j.com/user/times_save';\r\n        request.open('POST', url, true);\r\n        request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        request.onreadystatechange = function () {\r\n            if (request.readyState === 4 && (request.status >= 200 && request.status < 300)) {\r\n\r\n            }\r\n        };\r\n        request.send('open_id='+openid+'&times=' + times);\r\n    },\r\n\r\n    sendCodePost(code,callback) {\r\n        let self = this;\r\n        let request = cc.loader.getXMLHttpRequest();\r\n        let url = 'https://game.i--j.com/api/jscode2session';\r\n        request.open('POST', url, true);\r\n        request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        request.onreadystatechange = function () {\r\n            if (request.readyState === 4 && (request.status >= 200 && request.status < 300)) {\r\n                let response = request.responseText;\r\n                response = JSON.parse(response);\r\n                console.log(response);\r\n                let openid = response.openid;\r\n                self.openid = openid;\r\n                console.log(self.openid);\r\n                if (callback){\r\n                    callback();\r\n                }\r\n            }\r\n        };\r\n        request.send('js_code=' + code);\r\n    },\r\n\r\n    sendUserInfo(userData,openid) {\r\n        let self = this;\r\n        let request = cc.loader.getXMLHttpRequest();\r\n        let url = 'https://game.i--j.com/user/save';\r\n        request.open('POST', url, true);\r\n        request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        request.onreadystatechange = function () {\r\n            if (request.readyState === 4 && (request.status >= 200 && request.status < 300)) {\r\n\r\n            }\r\n        };\r\n        this.nickName=userData.userInfo.nickName;\r\n        this.avatar=userData.userInfo.avatarUrl;\r\n        console.log('发送玩家信息'+this.nickName);\r\n        let getData = querystring.stringify({\r\n            open_id:openid,\r\n            nick_name: userData.userInfo.nickName,\r\n            avatar_url: userData.userInfo.avatarUrl,\r\n            gender: userData.userInfo.gender,\r\n            country: userData.userInfo.country,\r\n            province: userData.userInfo.province,\r\n            city: userData.userInfo.city,\r\n        });\r\n\r\n\r\n        console.log(getData);\r\n        request.send(getData);\r\n    }\r\n};\r\n\r\nmodule.exports = Global;"]}